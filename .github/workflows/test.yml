name: CI (Repo-Dispatch)
on:
  repository_dispatch:
    types: [ci]
  workflow_dispatch:
    inputs:
      repo:
        description: "Triggered repo"
        required: true
        default: "mbsim"
        type: choice
        options:
        - fmatvec
        - hdf5serie
        - openmbv
        - mbsim
      branch:
        description: "Triggered branch in repo"
        required: true
        default: "master"
        type: string
      sha:
        description: "Triggered sha in repo"
        required: true
        default: ""
        type: string
env:
jobs:
  getBuildMatrix:
    name: Get build matrix
    uses: ./.github/workflows/mbsim-env-getbuildmatrix.yml
    with:
      dailyRun: false
      #pushSource: ${{ (github.event_name == 'workflow_dispatch' && toJson({"repository": inputs.repo, "ref_name": inputs.branch, "sha": inputs.sha})) || toJson(github.event.client_payload) }}
      pushSource: ${{ (github.event_name == 'workflow_dispatch' && 'mfmf') || toJson(github.event.client_payload) }}
